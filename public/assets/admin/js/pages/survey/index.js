/*Font Icons*/var fnt_icons = ['icon-music','icon-lemon','icon-mail','icon-mail-alt','icon-heart','icon-heart-empty','icon-star','icon-star-empty','icon-star-half','icon-star-half-alt','icon-user','icon-users','icon-male','icon-female','icon-video','icon-videocam','icon-picture','icon-camera','icon-camera-alt','icon-th-large','icon-th','icon-th-list','icon-ok','icon-ok-circled','icon-ok-circled2','icon-ok-squared','icon-cancel','icon-cancel-circled','icon-cancel-circled2','icon-plus','icon-plus-circled','icon-plus-squared','icon-plus-squared-small','icon-minus','icon-minus-circled','icon-minus-squared','icon-minus-squared-alt','icon-minus-squared-small','icon-help','icon-help-circled','icon-info-circled','icon-info','icon-home','icon-link','icon-unlink','icon-link-ext','icon-link-ext-alt','icon-attach','icon-lock','icon-lock-open','icon-lock-open-alt','icon-pin','icon-eye','icon-eye-off','icon-tag','icon-tags','icon-bookmark','icon-bookmark-empty','icon-flag','icon-flag-empty','icon-flag-checkered','icon-thumbs-up','icon-thumbs-down','icon-thumbs-up-alt','icon-thumbs-down-alt','icon-download','icon-upload','icon-download-cloud','icon-upload-cloud','icon-reply','icon-reply-all','icon-forward','icon-quote-left','icon-quote-right','icon-code','icon-export','icon-export-alt','icon-pencil','icon-pencil-squared','icon-edit','icon-print','icon-retweet','icon-keyboard','icon-gamepad','icon-comment','icon-chat','icon-comment-empty','icon-chat-empty','icon-bell','icon-bell-alt','icon-attention-alt','icon-attention','icon-attention-circled','icon-location','icon-direction','icon-compass','icon-trash','icon-doc','icon-docs','icon-doc-text','icon-doc-inv','icon-doc-text-inv','icon-folder','icon-folder-open','icon-folder-empty','icon-folder-open-empty','icon-box','icon-rss','icon-rss-squared','icon-phone','icon-phone-squared','icon-menu','icon-cog','icon-cog-alt','icon-wrench','icon-basket','icon-calendar','icon-calendar-empty','icon-login','icon-logout','icon-mic','icon-mute','icon-volume-off','icon-volume-down','icon-volume-up','icon-headphones','icon-clock','icon-lightbulb','icon-block','icon-resize-full','icon-resize-full-alt','icon-resize-small','icon-resize-vertical','icon-resize-horizontal','icon-move','icon-zoom-in','icon-zoom-out','icon-down-circled2','icon-up-circled2','icon-left-circled2','icon-right-circled2','icon-down-dir','icon-up-dir','icon-left-dir','icon-right-dir','icon-down-open','icon-left-open','icon-right-open','icon-up-open','icon-angle-left','icon-angle-right','icon-angle-up','icon-angle-down','icon-angle-circled-left','icon-angle-circled-right','icon-angle-circled-up','icon-angle-circled-down','icon-angle-double-left','icon-angle-double-right','icon-angle-double-up','icon-angle-double-down','icon-down','icon-left','icon-right','icon-up','icon-down-big','icon-left-big','icon-right-big','icon-up-big','icon-right-hand','icon-left-hand','icon-up-hand','icon-down-hand','icon-left-circled','icon-right-circled','icon-up-circled','icon-down-circled','icon-cw','icon-ccw','icon-arrows-cw','icon-level-up','icon-level-down','icon-shuffle','icon-exchange','icon-search','icon-collapse','icon-expand-right','icon-collapse-left','icon-play','icon-play-circled','icon-play-circled2','icon-stop','icon-pause','icon-to-end','icon-to-end-alt','icon-to-start','icon-to-start-alt','icon-fast-fw','icon-fast-bw','icon-eject','icon-target','icon-signal','icon-award','icon-desktop','icon-laptop','icon-tablet','icon-mobile','icon-inbox','icon-globe','icon-sun','icon-cloud','icon-flash','icon-moon','icon-umbrella','icon-flight','icon-fighter-jet','icon-leaf','icon-font','icon-bold','icon-italic','icon-text-height','icon-text-width','icon-align-left','icon-align-center','icon-align-right','icon-align-justify','icon-list','icon-indent-left','icon-indent-right','icon-list-bullet','icon-list-numbered','icon-strike','icon-underline','icon-superscript','icon-subscript','icon-table','icon-columns','icon-crop','icon-scissors','icon-paste','icon-briefcase','icon-suitcase','icon-ellipsis','icon-ellipsis-vert','icon-off','icon-road','icon-list-alt','icon-qrcode','icon-barcode','icon-book','icon-ajust','icon-tint','icon-check','icon-check-empty','icon-circle','icon-circle-empty','icon-dot-circled','icon-asterisk','icon-gift','icon-fire','icon-magnet','icon-chart-bar','icon-ticket','icon-credit-card','icon-floppy','icon-megaphone','icon-hdd','icon-key','icon-fork','icon-rocket','icon-bug','icon-certificate','icon-tasks','icon-filter','icon-beaker','icon-magic','icon-truck','icon-money','icon-euro','icon-pound','icon-dollar','icon-rupee','icon-yen','icon-rouble','icon-try','icon-won','icon-bitcoin','icon-sort','icon-sort-down','icon-sort-up','icon-sort-alt-up','icon-sort-alt-down','icon-sort-name-up','icon-sort-name-down','icon-sort-number-up','icon-sort-number-down','icon-hammer','icon-gauge','icon-sitemap','icon-spinner','icon-coffee','icon-food','icon-beer','icon-user-md','icon-stethoscope','icon-ambulance','icon-medkit','icon-h-sigh','icon-hospital','icon-building','icon-smile','icon-frown','icon-meh','icon-anchor','icon-terminal','icon-eraser','icon-puzzle','icon-shield','icon-extinguisher','icon-bullseye','icon-wheelchair','icon-adn','icon-android','icon-apple','icon-bitbucket','icon-bitbucket-squared','icon-css3','icon-dribbble','icon-dropbox','icon-facebook','icon-facebook-squared','icon-flickr','icon-foursquare','icon-github','icon-github-squared','icon-github-circled','icon-gittip','icon-gplus-squared','icon-gplus','icon-html5','icon-instagramm','icon-linkedin-squared','icon-linux','icon-linkedin','icon-maxcdn','icon-pagelines','icon-pinterest-circled','icon-pinterest-squared','icon-renren','icon-skype','icon-stackexchange','icon-stackoverflow','icon-trello','icon-tumblr','icon-tumblr-squared','icon-twitter-squared','icon-twitter','icon-vimeo-squared','icon-vkontakte','icon-weibo','icon-windows','icon-xing','icon-xing-squared','icon-youtube','icon-youtube-squared','icon-youtube-play','icon-blank','icon-expand'];$(function() {    if ($('#records').length) records.init();    if ($('.uk-nestable').length) records.sorting();    if ($(".uk-pagination").length) records.pagination();    records.survey();    /*Datetime Picker*/    records.date_range();    records.search();    records.download();	records.fetch_result();	records.fetch_aggregate();});records = {    init: function() {        $('#records').jtable({            title: 'Manage Surveys',            paging: true //Enable paging                ,            messages: {                addNewRecord: 'Add Survey',                editRecord: 'Edit Survey',                areYouSure: 'Are you sure?',            },            pageSize: 10 //Set page size (default: 10)                ,            sorting: false,            addRecordButton: $('#recordAdd'),            deleteConfirmation: function(data) {                data.deleteConfirmMessage = 'Are you sure to delete survey ' + data.record.title + '?';            },            formCreated: function(event, data) {                reInitDesign(event, data);            },            recordsLoaded: function(event, data) {                if (!update_survey) $(".jtable-edit-command-button").parent().hide();                if (!delete_survey) $(".jtable-delete-command-button").parent().hide();            },            actions: {                listAction: surveys + "?type=surveys",                //createAction: survey_create + "?type=survey_create",                //updateAction: survey_update + "?type=survey_update",                //deleteAction: survey_delete + "?type=survey_delete"            },            fields: {                id: {                    key: true,                    create: false,                    edit: false,                    list: false                },                survey_field: {                    title: 'Questions',                    width: '1%',                    paging: false,                    sorting: false,                    create: false,                    edit: false,                    display: function(SurveyInfo) {                        var $link = $('<i class="material-icons">low_priority</i>');                        $link.click(function() {                            $('#records').jtable('openChildTable', $link.closest('tr'), {                                title: '&nbsp;',                                paging: true,                                sorting: false,                                formCreated: function(event, data) {                                    reInitDesign(event, data);                                },                                actions: {                                    listAction: surveys + "?type=survey_fields",                                   // createAction: survey_create + "?type=survey_field_create",                                    //updateAction: survey_update + "?type=survey_field_update",                                    //deleteAction: survey_delete + "?type=survey_field_delete"                                },                                fields: {                                    id: {                                        key: true,                                        edit: false,                                        list: false                                    },                                    survey_field_value: {                                        title: 'Options',                                        width: '1%',                                        paging: false,                                        sorting: false,                                        create: false,                                        edit: false,                                        display: function(SurveyFieldInfo) {                                            if ($.inArray(SurveyFieldInfo.record.type, ['text', 'textarea', 'date', 'starrating', 'progressbar', 'barrating']) == -1) {                                                var $link = $('<i class="material-icons">low_priority</i>');                                                $link.click(function() {                                                    $('#records').jtable('openChildTable', $link.closest('tr'), {                                                        title: '&nbsp;',                                                        paging: true,                                                        sorting: false,                                                        formCreated: function(event, data) {															/*Font icon Picker*/															/* $('[name=icon]').fontIconPicker({																source: fnt_icons,																theme: 'fip-bootstrap'															}); */															/*color picker*/															/* data.form.find('[name=color]').spectrum({																preferredFormat: "hex",																showInput: true,																showPalette: true,																palette: [["red", "rgba(0, 255, 0, .5)", "rgb(0, 0, 255)"]]															}); */                                                            reInitDesign(event, data);                                                        },                                                        actions: {                                                            listAction: surveys + "?type=survey_field_values",                                                            //createAction: survey_create + "?type=survey_field_value_create",                                                           // updateAction: survey_update + "?type=survey_field_value_update",                                                            //deleteAction: survey_delete + "?type=survey_field_value_delete"                                                        },                                                        fields: {                                                            id: {                                                                key: true,                                                                edit: false,                                                                list: false                                                            },															/* icon: {																title: 'Font Icon'																, type: 'text'																, create: true																, edit: true																, list: true															},															color: {																title: 'Font Icon Color'																, type: 'text'																, create: true																, edit: true																, list: true																, inputClass: 'basic'															}, */                                                            value: {                                                                title: 'Option',                                                                input: function(data) {                                                                    if (data.record) {																		return '<div class="md-input-wrapper md-input-filled"><div class="md-input-wrapper"><input type="text" name="value" class="md-input" value="' + data.record.value + '"><span class="uk-form-help-block">Text (English)</span></div><span class="md-input-bar "></span></div><div style="display:none" class="md-input-wrapper md-input-filled"><div class="md-input-wrapper"><input type="text" name="value_ar" class="md-input" value="' + data.record.value_ar + '"><span class="uk-form-help-block">Text (Arabic)</span></div><span class="md-input-bar "></span></div>';																	} else {																		return '<div class="md-input-wrapper md-input-filled"><div class="md-input-wrapper"><input type="text" name="value" class="md-input"><span class="uk-form-help-block">Text (English)</span></div><span class="md-input-bar "></span></div><div style="display:none" class="md-input-wrapper md-input-filled"><div class="md-input-wrapper"><input type="text" name="value_ar" class="md-input"><span class="uk-form-help-block">Text (Arabic)</span></div><span class="md-input-bar "></span></div>';																	}                                                                },                                                                display: function(data) {                                                                    return data.record.value;                                                                }                                                            },                                                            survey_field_id: {                                                                type: 'hidden',                                                                create: true,                                                                edit: true,                                                                list: false,                                                                defaultValue: SurveyFieldInfo.record.id                                                            },                                                            survey_id: {                                                                type: 'hidden',                                                                create: true,                                                                edit: true,                                                                list: false,                                                                defaultValue: SurveyInfo.record.id                                                            }                                                        }                                                    }, function(data) { //opened handler                                                        data.childTable.jtable('load', {                                                            survey_field_id: SurveyFieldInfo.record.id,                                                            survey_id: SurveyInfo.record.id                                                        });                                                    });                                                });                                                return $link;                                            }                                        }                                    },                                    label: {                                        title: 'Question',                                        sorting: false,                                        display: function(data) {                                            return data.record.label;                                        }                                    }                                    /* , label_ar: {                                    	title: 'Question (Arabic)'                                    	, sorting: false                                    	, list: false                                    	, display: function(data) {                                    		return data.record.label_ar;                                    	}                                    } */                                    ,                                    type: {                                        title: 'Type',                                        options: {                                            'text': 'Textbox',                                            'textarea': 'Textarea',                                            'select': 'Drop Down (Multi Selection)',                                            'dropdown': 'Drop Down (Single Selection)',                                            'checkbox': 'Check Box',                                            'checkboxsquare': 'Check Box (Square)',                                            'radio': 'Radio Button',                                            'date': 'Date',                                            'starrating': 'Star Rating',                                            'progressbar': 'Progress Bar',                                            'checkboxicon': 'Multi Icon Selection',                                            'radioicon': 'Single Icon Selection',                                            'barrating': 'Bar Rating'                                        }                                    },                                    /* category_id: {                                        title: 'Category',                                        options: categories,                                        create: true,                                        edit: true,                                        list: true                                    }, */                                    active: {                                        title: 'Active',                                        options: {                                            '0': 'Not Active',                                            '1': 'Active'                                        }                                    },                                    require: {                                        title: 'Mandatory',                                        options: {                                            '0': 'Not Active',                                            '1': 'Active'                                        }                                    },                                    is_grid: {                                        title: 'Show on Backend Listing',                                        options: {                                            '1': 'Yes',                                            '0': 'No'                                        }                                    },                                    survey_id: {                                        type: 'hidden',                                        create: true,                                        edit: true,                                        list: false,                                        defaultValue: SurveyInfo.record.id                                    }                                }                            }, function(data) { //opened handler                                data.childTable.jtable('load', {                                    survey_id: SurveyInfo.record.id                                });                            });                        });                        return $link;                    }                },                title: {                    title: 'Title',                    create: true,                    edit: true,                    list: true,                    type: 'text'                }                /* , title_ar: {                	title: 'Title (Arabic)'                	, create: true                	, edit: true                	, list: false                	, type: 'text'                } */                ,                description1: {                    title: 'Welcome Message',                    create: true,                    edit: true,                    list: true,                    type: 'text'                }                /* , description1_ar: {                	title: 'Description-1 (Arabic)'                	, create: true                	, edit: true                	, list: false                	, type: 'text'                } */                ,                description2: {                    title: 'Thankyou Message',                    create: true,                    edit: true,                    list: true,                    type: 'text'                }                /* , description2_ar: {                	title: 'Description-2 (Arabic)'                	, create: true                	, edit: true                	, list: false                	, type: 'text'                } */                ,                /* active: {                    title: 'Active',                    options: {                        '0': 'Not Active',                        '1': 'Active'                    }                }, */                /* copy: {                    title: '&nbsp;',                    width: '1%',                    paging: false,                    sorting: false,                    create: false,                    edit: false,                    display: function(SurveyInfo) {                        if (copy_survey) {                            var $link = $('<i class="material-icons">filter_2</i>');                            $link.click(function() {                                UIkit.modal.confirm('Are you sure to create a copy of survey?', function() {                                    $.post(survey_copy, {                                        survey_id: SurveyInfo.record.id                                    }, function(result) {                                        $('#records').jtable('load');                                    });                                });                            });                            return $link;                        }                    }                }, */                sorting: {                    title: '&nbsp;',                    width: '1%',                    sorting: false,                    create: false,                    edit: false,                    list: (sorting_survey ? true : false),                    display: function(SurveyInfo) {                        return '<a href="' + survey_sorting + '/' + SurveyInfo.record.id + '"><i class="material-icons">sort</i></a>';                    }                }            }        }).jtable('load');        $('.ui-dialog-buttonset').children('button').attr('class', '').addClass('md-btn md-btn-flat').off('mouseenter focus');        $('#AddRecordDialogSaveButton,#EditDialogSaveButton,#DeleteDialogButton').addClass('md-btn-flat-primary');        $('#search').click(function(e) {            e.preventDefault();            $('#records').jtable('load', {                name: $('[name=name]').val()            });        });    },    sorting: function() {        $(".uk-nestable").sortable({            opacity: 0.8,            cursor: 'move',            update: function() {                var order = $(this).sortable("serialize") + '&update=update';                $.post(sorting, order);            }        });    },    survey: function() {        $("[name=survey]").change(function() {            $(this).parents('form:first').submit();        });    },    pagination: function() {        $(document).on("click", ".uk-pagination li a", function(e) {            $('.ajax_form').attr('action', $(this).attr('href')).submit();            return false;        });    },    date_range: function() {        var t = $("[name=start]"),            e = $("[name=end]"),            i = UIkit.datepicker(t, {                format: "MMMM DD, YYYY"            }),            n = UIkit.datepicker(e, {                format: "MMMM DD, YYYY"            });        t.on("change", function() {            n.options.minDate = t.val(), setTimeout(function() {                e.focus()            }, 300)        }), e.on("change", function() {            i.options.maxDate = e.val()        })    },    search: function() {        $(document).on("click", "[name=search]", function(e) {            $(this).parents('.ajax_form:first').submit();            return false;        });    },    download: function() {        $("[name=download]").click(function(e) {            $(this).parents('form:first').attr('action', $(this).data('href')).removeClass('ajax_form').submit();        });    },    fetch_result: function() {		$(document).on("click", ".fetch-result", function(e){			var $this = $(this);			altair_helpers.content_preloader_show();			$.post(fetch_result, {id: $this.data('id')}, function(result){				$("#fetch-result .submission-result").html(result.records);				altair_helpers.content_preloader_hide();				var modal = UIkit.modal("#fetch-result");				modal.show();			}, "json");		});    },    fetch_aggregate: function() {		$(document).on("click", ".aggregate", function(e){			var $this = $(this);			altair_helpers.content_preloader_show();			$.post(fetch_aggregate, {id: $this.data('id'), type: $this.data('type')}, function(result){				$("#aggregate img").attr('src', ($this.data('type') == "primary" ? result.behavior : result.sub_behavior));				altair_helpers.content_preloader_hide();				var modal = UIkit.modal("#aggregate");				modal.show();			}, "json");		});	}};function OpenEditFriendPopup(id, fname, lname, email) {    $.confirm({        title: 'Update',        content: '<div class="uk-grid" data-uk-grid-margin><div class="uk-width-medium-1-1"><label for="fname">First Name</label><input type="text" name="fname" value="' + fname + '" class="md-input" id="fname"></div><div class="uk-width-medium-1-1"><label for="lname">Last Name</label><input type="text" name="lname" value="' + lname + '" class="md-input" id="lname"></div><div class="uk-width-medium-1-1"><label for="email">Email</label><input type="text" name="email" value="' + email + '" class="md-input" id="email"></div></div>',        boxWidth: '30%',        useBootstrap: false,        buttons: {            confirm: function () {                var self = this;                var fname = self.$content.find('[name=fname]').val();                var lname = self.$content.find('[name=lname]').val();                var email = self.$content.find('[name=email]').val();                altair_helpers.content_preloader_show();                $.post(update_friend_info, {id: id, fname: fname, lname: lname, email: email}, function (result) {                    altair_helpers.content_preloader_hide();                    $.alert({                        title: 'Alert!',                        content: result.message,                        boxWidth: '30%',                        useBootstrap: false,                    });                    setTimeout(function () {                        window.location.reload();                    }, 1000);                }, "json");            },            cancel: function () {            }        }    });}