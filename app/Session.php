<?phpnamespace App;use Illuminate\Database\Eloquent\Model;use DB;class Session extends Model{	protected $table = 'sessions';		protected $primaryKey = 'id, email_sent';		public $timestamps = true;		protected $fillable = array('name', 'group_id');    public static function session_survey($session_id)    {        $data = DB::table('sessions')->leftJoin('employee', function ($join) {            $join->on('employee.session_id', '=', 'sessions.id');        })->leftJoin('survey_submission', function ($join) {            $join->on('survey_submission.employee_id', '=', 'employee.id')->whereNull('survey_submission.employee_friend_id');        })->where('sessions.id',$session_id);        $data->orderBy('employee.id','asc');        $data->groupBy('employee.id');        $data->select('employee.id as emp_id','employee.*', 'survey_submission.*', DB::raw("(SELECT COUNT(*) from friend_assessment WHERE friend_assessment.employee_id=employee.id AND friend_assessment.is_submit = 1) as total_friend_submissions"), DB::raw("(SELECT COUNT(*) from friend_assessment WHERE friend_assessment.employee_id=employee.id) as total_friends"));        return $data;    }}?>