<?phpnamespace App\Http\Middleware;use Closure;use Illuminate\Support\Facades\Auth;use App\User;use Spatie\Permission\Models\Role;use Route;class ClearanceMiddleware{    /**     * Handle an incoming request.     *     * @param  \Illuminate\Http\Request  $request     * @param  \Closure  $next     * @return mixed     */    public function handle($request, Closure $next) {        		/*User Route Permission*/		if(!Auth::user()->hasRole('administrator'))		{			if (Route::is('admin-user'))			{				if (!Auth::user()->hasPermissionTo('user view'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-user-create'))			{				if (!Auth::user()->hasPermissionTo('user create'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-user-update'))			{				if (!Auth::user()->hasPermissionTo('user update'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-user-delete'))			{				if (!Auth::user()->hasPermissionTo('user delete'))				{					abort('404');				} 				else {					return $next($request);				}			}			/*Role Route Permission*/			if (Route::is('admin-role'))			{				if (!Auth::user()->hasPermissionTo('role view'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-role-create'))			{				if (!Auth::user()->hasPermissionTo('role create'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-role-update'))			{				if (!Auth::user()->hasPermissionTo('role update'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-role-delete'))			{				if (!Auth::user()->hasPermissionTo('role delete'))				{					abort('404');				} 				else {					return $next($request);				}			}			/*Category Route Permission*/			if (Route::is('admin-category'))			{				if (!Auth::user()->hasPermissionTo('category view'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-category-create'))			{				if (!Auth::user()->hasPermissionTo('category create'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-category-update'))			{				if (!Auth::user()->hasPermissionTo('category update'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-category-delete'))			{				if (!Auth::user()->hasPermissionTo('category delete'))				{					abort('404');				} 				else {					return $next($request);				}			}			/*Session Route Permission*/            if (Route::is('admin-session'))            {                if (!Auth::user()->hasPermissionTo('session view'))                {                    abort('404');                }                else {                    return $next($request);                }            }            if (Route::is('admin-session-create'))            {                if (!Auth::user()->hasPermissionTo('session create'))                {                    abort('404');                }                else {                    return $next($request);                }            }            if (Route::is('admin-session-update'))            {                if (!Auth::user()->hasPermissionTo('session update'))                {                    abort('404');                }                else {                    return $next($request);                }            }            if (Route::is('admin-session-delete'))            {                if (!Auth::user()->hasPermissionTo('session delete'))                {                    abort('404');                }                else {                    return $next($request);                }            }			/*Survey Route Permission*/			if (Route::is('admin-survey'))			{				if (!Auth::user()->hasPermissionTo('survey view'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-survey-create'))			{				if (!Auth::user()->hasPermissionTo('survey create'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-survey-update'))			{				if (!Auth::user()->hasPermissionTo('survey update'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-survey-delete'))			{				if (!Auth::user()->hasPermissionTo('survey delete'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-survey-copy'))			{				if (!Auth::user()->hasPermissionTo('survey copy'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-survey-sorting'))			{				if (!Auth::user()->hasPermissionTo('survey sorting'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-submissions'))			{				if (!Auth::user()->hasPermissionTo('survey submissions'))				{					abort('404');				} 				else {					return $next($request);				}			}			if (Route::is('admin-survey-download'))			{				if (!Auth::user()->hasPermissionTo('survey excel report'))				{					abort('404');				} 				else {					return $next($request);				}			}		}		        return $next($request);    }}